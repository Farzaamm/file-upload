<!DOCTYPE html>
<html lang="en">
<%- include('partials/head') -%>
<body>
    <header>
        <%- include('partials/nav') -%>
    </header>

    <main>
        <h1>File Upload</h1>
        <div class="form">
            <form id="uploadForm" action="/api/upload" method="post" enctype="multipart/form-data">
                <input type="file" name="file" id="fileInput" required>
                <button type="submit">Upload</button>
            </form>
        </div>
        <p id="message"></p>
    </main>

    <%- include('partials/footer') -%>
</body>

<script>
    document.getElementById('uploadForm').addEventListener('submit', function (e) {
        e.preventDefault();

        const form = e.target;
        const formData = new FormData(form);

        fetch(form.action, {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (!response.ok) throw new Error('Upload failed');
            return response.text();
        })
        .then(data => {
            document.getElementById('message').textContent = 'Upload successful!';
            document.getElementById('fileInput').value = '';
        })
        .catch(err => {
            console.error(err);
            document.getElementById('message').textContent = 'Upload failed!';
        });
    });
</script>
</html>